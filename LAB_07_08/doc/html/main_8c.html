<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SETR Vending Machine Project: src/main.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SETR Vending Machine Project
   &#160;<span id="projectnumber">V1.0</span>
   </div>
   <div id="projectbrief">This project implements a vending machine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('main_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">main.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Program that implements the State Machine of a vending machine.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;zephyr.h&gt;</code><br />
<code>#include &lt;device.h&gt;</code><br />
<code>#include &lt;devicetree.h&gt;</code><br />
<code>#include &lt;drivers/gpio.h&gt;</code><br />
<code>#include &lt;sys/printk.h&gt;</code><br />
<code>#include &lt;sys/__assert.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;timing/timing.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;float.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for main.c:</div>
<div class="dyncontent">
<div class="center"><img src="main_8c__incl.png" border="0" usemap="#src_2main_8c" alt=""/></div>
<map name="src_2main_8c" id="src_2main_8c">
<area shape="rect" title="Program that implements the State Machine of a vending machine." alt="" coords="543,5,632,32"/>
<area shape="rect" title=" " alt="" coords="5,80,84,107"/>
<area shape="rect" title=" " alt="" coords="109,80,186,107"/>
<area shape="rect" title=" " alt="" coords="211,80,313,107"/>
<area shape="rect" title=" " alt="" coords="337,80,448,107"/>
<area shape="rect" title=" " alt="" coords="473,80,571,107"/>
<area shape="rect" title=" " alt="" coords="595,80,710,107"/>
<area shape="rect" title=" " alt="" coords="735,80,805,107"/>
<area shape="rect" title=" " alt="" coords="830,80,953,107"/>
<area shape="rect" title=" " alt="" coords="977,80,1043,107"/>
<area shape="rect" title=" " alt="" coords="1067,80,1131,107"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a34e2504f779a76bb8ee19df1bbaa14a2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a34e2504f779a76bb8ee19df1bbaa14a2">NPRODUCTS</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a34e2504f779a76bb8ee19df1bbaa14a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a47b19b66290aa414c508fe6f5039c4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a3a47b19b66290aa414c508fe6f5039c4">SLEEP_MS</a>&#160;&#160;&#160;250</td></tr>
<tr class="separator:a3a47b19b66290aa414c508fe6f5039c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef72fe86b7c60b1a86920496456edeac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#aef72fe86b7c60b1a86920496456edeac">WAIT</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:aef72fe86b7c60b1a86920496456edeac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acedf3113022062c142e67f4e03468a70"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#acedf3113022062c142e67f4e03468a70">UPDATE_CREDIT</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:acedf3113022062c142e67f4e03468a70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7029b739f2392ac365e0addec2b3089"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ae7029b739f2392ac365e0addec2b3089">UPDATE_PRODUCT</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ae7029b739f2392ac365e0addec2b3089"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38b9cc1a2b4dd44844b60864e122daf9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a38b9cc1a2b4dd44844b60864e122daf9">CHECK_CREDIT</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a38b9cc1a2b4dd44844b60864e122daf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a655c84af1b0034986ff56e12e84f983d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a655c84af1b0034986ff56e12e84f983d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1965eaca47dbf3f87acdafc2208f04eb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a1965eaca47dbf3f87acdafc2208f04eb">UP</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a1965eaca47dbf3f87acdafc2208f04eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4193cd1c8c2e6ebd0e056fa2364a663f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a4193cd1c8c2e6ebd0e056fa2364a663f">DOWN</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a4193cd1c8c2e6ebd0e056fa2364a663f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53dc4af00adc7b3b4d12eafb71596dfc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a53dc4af00adc7b3b4d12eafb71596dfc">SELECT</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a53dc4af00adc7b3b4d12eafb71596dfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a0e6b80dd3d5ca395cf58151749f5e2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a6a0e6b80dd3d5ca395cf58151749f5e2">RETURN</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a6a0e6b80dd3d5ca395cf58151749f5e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c0e6f34369bef1deb3a9efae6ac14fb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a4c0e6f34369bef1deb3a9efae6ac14fb">GPIO0_NID</a>&#160;&#160;&#160;DT_NODELABEL(gpio0)</td></tr>
<tr class="separator:a4c0e6f34369bef1deb3a9efae6ac14fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3c05b8933cd253785fdd123f6dbfc18"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ad3c05b8933cd253785fdd123f6dbfc18">BOARDBUT1</a>&#160;&#160;&#160;0xb</td></tr>
<tr class="separator:ad3c05b8933cd253785fdd123f6dbfc18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a590d906828bd5948fafbef47dc1c3b0c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a590d906828bd5948fafbef47dc1c3b0c">BOARDBUT2</a>&#160;&#160;&#160;0xc</td></tr>
<tr class="separator:a590d906828bd5948fafbef47dc1c3b0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e82ac21050552495e5a8551178bf258"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a2e82ac21050552495e5a8551178bf258">BOARDBUT3</a>&#160;&#160;&#160;0x18</td></tr>
<tr class="separator:a2e82ac21050552495e5a8551178bf258"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abee96e1280405ff973ee2b6b07eec104"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#abee96e1280405ff973ee2b6b07eec104">BOARDBUT4</a>&#160;&#160;&#160;0x19</td></tr>
<tr class="separator:abee96e1280405ff973ee2b6b07eec104"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51df65f6b8a8c48cbec3c9fed14c1b0a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a51df65f6b8a8c48cbec3c9fed14c1b0a">BUTUP</a>&#160;&#160;&#160;0x03</td></tr>
<tr class="separator:a51df65f6b8a8c48cbec3c9fed14c1b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3ff019b0ba300edea3866aab05c5f32"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#af3ff019b0ba300edea3866aab05c5f32">BUTDOWN</a>&#160;&#160;&#160;0x04</td></tr>
<tr class="separator:af3ff019b0ba300edea3866aab05c5f32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87b5b6d26412c75c3e3016078354662e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a87b5b6d26412c75c3e3016078354662e">BUTSELECT</a>&#160;&#160;&#160;0x1c</td></tr>
<tr class="separator:a87b5b6d26412c75c3e3016078354662e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac026ff88ff97a4510fd9c9a69afcc15"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#aac026ff88ff97a4510fd9c9a69afcc15">BUTRETURN</a>&#160;&#160;&#160;0x1d</td></tr>
<tr class="separator:aac026ff88ff97a4510fd9c9a69afcc15"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0145d2779f99dabdb58535a77d802575"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a0145d2779f99dabdb58535a77d802575">input_output_config</a> (void)</td></tr>
<tr class="memdesc:a0145d2779f99dabdb58535a77d802575"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration Function.  <a href="main_8c.html#a0145d2779f99dabdb58535a77d802575">More...</a><br /></td></tr>
<tr class="separator:a0145d2779f99dabdb58535a77d802575"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf4f25cec93a1b71a82f3f3e9851b779"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#adf4f25cec93a1b71a82f3f3e9851b779">float2int</a> (float arg, int *whole, int *remainder)</td></tr>
<tr class="memdesc:adf4f25cec93a1b71a82f3f3e9851b779"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to transform float number in two integer numbers.  <a href="main_8c.html#adf4f25cec93a1b71a82f3f3e9851b779">More...</a><br /></td></tr>
<tr class="separator:adf4f25cec93a1b71a82f3f3e9851b779"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacb920cba80b4bc4b2b7cdb44f516cc6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#aacb920cba80b4bc4b2b7cdb44f516cc6">butcoinpress_cbfunction</a> (const struct device *dev, struct gpio_callback *cb, uint32_t pins)</td></tr>
<tr class="memdesc:aacb920cba80b4bc4b2b7cdb44f516cc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function of the interrupt from the four board buttons.  <a href="main_8c.html#aacb920cba80b4bc4b2b7cdb44f516cc6">More...</a><br /></td></tr>
<tr class="separator:aacb920cba80b4bc4b2b7cdb44f516cc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c05989a2d3eeb24dbbd8ac9b005abe0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a7c05989a2d3eeb24dbbd8ac9b005abe0">butpanelpress_cbfunction</a> (const struct device *dev, struct gpio_callback *cb, uint32_t pins)</td></tr>
<tr class="memdesc:a7c05989a2d3eeb24dbbd8ac9b005abe0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function of the interrupt from the four panel control buttons.  <a href="main_8c.html#a7c05989a2d3eeb24dbbd8ac9b005abe0">More...</a><br /></td></tr>
<tr class="separator:a7c05989a2d3eeb24dbbd8ac9b005abe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6288eba0f8e8ad3ab1544ad731eb7667"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a6288eba0f8e8ad3ab1544ad731eb7667">main</a> (void)</td></tr>
<tr class="memdesc:a6288eba0f8e8ad3ab1544ad731eb7667"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main function of program.  <a href="main_8c.html#a6288eba0f8e8ad3ab1544ad731eb7667">More...</a><br /></td></tr>
<tr class="separator:a6288eba0f8e8ad3ab1544ad731eb7667"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a19c255bf49fc3ac23d3b62e25a5ce365"><td class="memItemLeft" align="right" valign="top">volatile float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a19c255bf49fc3ac23d3b62e25a5ce365">coin</a> = 0</td></tr>
<tr class="separator:a19c255bf49fc3ac23d3b62e25a5ce365"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac34533d63de3056364aa3eb56553fe1a"><td class="memItemLeft" align="right" valign="top">volatile int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ac34533d63de3056364aa3eb56553fe1a">coin_detected</a> = 0</td></tr>
<tr class="separator:ac34533d63de3056364aa3eb56553fe1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a398c25065c498b1c2e76b8047825bcbc"><td class="memItemLeft" align="right" valign="top">volatile int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a398c25065c498b1c2e76b8047825bcbc">button_pressed</a> = <a class="el" href="main_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a></td></tr>
<tr class="separator:a398c25065c498b1c2e76b8047825bcbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Program that implements the State Machine of a vending machine. </p>
<p>The program accepts a subset of coins and allows the user to browse through the available products, buy one product and return the credit. The inputs are push-buttons and the output is done via UART/Terminal. It was implemented using the board Nordic nrf52840-dk. The state machine is on the next Statechart.</p>
<div class="image">
<img src="UML_Statechart.png" alt=""/>
</div>
<dl class="section author"><dt>Author</dt><dd>André Brandão </dd>
<dd>
Emanuel Pereira </dd></dl>
<dl class="section date"><dt>Date</dt><dd>10/05/2022 </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ad3c05b8933cd253785fdd123f6dbfc18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3c05b8933cd253785fdd123f6dbfc18">&#9670;&nbsp;</a></span>BOARDBUT1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BOARDBUT1&#160;&#160;&#160;0xb</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Address of Board button 1 used for coin 10 cents </p>

</div>
</div>
<a id="a590d906828bd5948fafbef47dc1c3b0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a590d906828bd5948fafbef47dc1c3b0c">&#9670;&nbsp;</a></span>BOARDBUT2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BOARDBUT2&#160;&#160;&#160;0xc</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Address of Board button 2 used for coin 20 cents </p>

</div>
</div>
<a id="a2e82ac21050552495e5a8551178bf258"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e82ac21050552495e5a8551178bf258">&#9670;&nbsp;</a></span>BOARDBUT3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BOARDBUT3&#160;&#160;&#160;0x18</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Address of Board button 3 used for coin 50 cents </p>

</div>
</div>
<a id="abee96e1280405ff973ee2b6b07eec104"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abee96e1280405ff973ee2b6b07eec104">&#9670;&nbsp;</a></span>BOARDBUT4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BOARDBUT4&#160;&#160;&#160;0x19</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Address of Board button 4 used for coin 1 euro </p>

</div>
</div>
<a id="af3ff019b0ba300edea3866aab05c5f32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3ff019b0ba300edea3866aab05c5f32">&#9670;&nbsp;</a></span>BUTDOWN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUTDOWN&#160;&#160;&#160;0x04</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Address of GPIO where button DOWN is connected </p>

</div>
</div>
<a id="aac026ff88ff97a4510fd9c9a69afcc15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac026ff88ff97a4510fd9c9a69afcc15">&#9670;&nbsp;</a></span>BUTRETURN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUTRETURN&#160;&#160;&#160;0x1d</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Address of GPIO where button RETURN is connected </p>

</div>
</div>
<a id="a87b5b6d26412c75c3e3016078354662e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87b5b6d26412c75c3e3016078354662e">&#9670;&nbsp;</a></span>BUTSELECT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUTSELECT&#160;&#160;&#160;0x1c</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Address of GPIO where button SELECT is connected </p>

</div>
</div>
<a id="a51df65f6b8a8c48cbec3c9fed14c1b0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51df65f6b8a8c48cbec3c9fed14c1b0a">&#9670;&nbsp;</a></span>BUTUP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUTUP&#160;&#160;&#160;0x03</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Address of GPIO where button UP is connected </p>

</div>
</div>
<a id="a38b9cc1a2b4dd44844b60864e122daf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38b9cc1a2b4dd44844b60864e122daf9">&#9670;&nbsp;</a></span>CHECK_CREDIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHECK_CREDIT&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>State Check Credit definition </p>

</div>
</div>
<a id="a4193cd1c8c2e6ebd0e056fa2364a663f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4193cd1c8c2e6ebd0e056fa2364a663f">&#9670;&nbsp;</a></span>DOWN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DOWN&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag to signal Down button was pressed </p>

</div>
</div>
<a id="a4c0e6f34369bef1deb3a9efae6ac14fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c0e6f34369bef1deb3a9efae6ac14fb">&#9670;&nbsp;</a></span>GPIO0_NID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GPIO0_NID&#160;&#160;&#160;DT_NODELABEL(gpio0)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>GPIO 0 Node Label from device tree (refer to dts file) </p>

</div>
</div>
<a id="a655c84af1b0034986ff56e12e84f983d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a655c84af1b0034986ff56e12e84f983d">&#9670;&nbsp;</a></span>NONE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NONE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag that indicates no button was pressed </p>

</div>
</div>
<a id="a34e2504f779a76bb8ee19df1bbaa14a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34e2504f779a76bb8ee19df1bbaa14a2">&#9670;&nbsp;</a></span>NPRODUCTS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NPRODUCTS&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of products available </p>

</div>
</div>
<a id="a6a0e6b80dd3d5ca395cf58151749f5e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a0e6b80dd3d5ca395cf58151749f5e2">&#9670;&nbsp;</a></span>RETURN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RETURN&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag to signal Return button was pressed </p>

</div>
</div>
<a id="a53dc4af00adc7b3b4d12eafb71596dfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53dc4af00adc7b3b4d12eafb71596dfc">&#9670;&nbsp;</a></span>SELECT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SELECT&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag to signal Select button was pressed </p>

</div>
</div>
<a id="a3a47b19b66290aa414c508fe6f5039c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a47b19b66290aa414c508fe6f5039c4">&#9670;&nbsp;</a></span>SLEEP_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SLEEP_MS&#160;&#160;&#160;250</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sleep period (ms) </p>

</div>
</div>
<a id="a1965eaca47dbf3f87acdafc2208f04eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1965eaca47dbf3f87acdafc2208f04eb">&#9670;&nbsp;</a></span>UP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UP&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag to signal Up button was pressed </p>

</div>
</div>
<a id="acedf3113022062c142e67f4e03468a70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acedf3113022062c142e67f4e03468a70">&#9670;&nbsp;</a></span>UPDATE_CREDIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UPDATE_CREDIT&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>State Update Credit definition </p>

</div>
</div>
<a id="ae7029b739f2392ac365e0addec2b3089"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7029b739f2392ac365e0addec2b3089">&#9670;&nbsp;</a></span>UPDATE_PRODUCT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UPDATE_PRODUCT&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>State Update Product definition </p>

</div>
</div>
<a id="aef72fe86b7c60b1a86920496456edeac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef72fe86b7c60b1a86920496456edeac">&#9670;&nbsp;</a></span>WAIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WAIT&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>State Wait definition </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aacb920cba80b4bc4b2b7cdb44f516cc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacb920cba80b4bc4b2b7cdb44f516cc6">&#9670;&nbsp;</a></span>butcoinpress_cbfunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void butcoinpress_cbfunction </td>
          <td>(</td>
          <td class="paramtype">const struct device *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct gpio_callback *&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>pins</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function of the interrupt from the four board buttons. </p>
<p>Interrupt function of four buttons that emulates the insertion of coins, whose values are: 10 cents, 20 cents, 50 cents and 1 EUR. This function executes when a board button is pressed and signals that a coin was inserted and returns the value of the inserted coin <br  />
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">coin</td><td>value of coin </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">coin_detected</td><td>flag to signal the insertion of a coin </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7c05989a2d3eeb24dbbd8ac9b005abe0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c05989a2d3eeb24dbbd8ac9b005abe0">&#9670;&nbsp;</a></span>butpanelpress_cbfunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void butpanelpress_cbfunction </td>
          <td>(</td>
          <td class="paramtype">const struct device *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct gpio_callback *&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>pins</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function of the interrupt from the four panel control buttons. </p>
<p>This function executes when a panel button is pressed and updates which button was pressed. <br  />
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">button_pressed</td><td>which button was pressed </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="adf4f25cec93a1b71a82f3f3e9851b779"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf4f25cec93a1b71a82f3f3e9851b779">&#9670;&nbsp;</a></span>float2int()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void float2int </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>whole</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>remainder</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to transform float number in two integer numbers. </p>
<p>This function converts a float number to two integral numbers, one of them being the integer part and the other the decimal part of the float number. The variables to store the integer and decimal part of the float number must be passed as pointers on the arguments of the function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">arg</td><td>Value of float number to convert </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">whole</td><td>Pointer to variable to store integer part of float number </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">remainder</td><td>Pointer to variable to store decimal part of float number </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0145d2779f99dabdb58535a77d802575"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0145d2779f99dabdb58535a77d802575">&#9670;&nbsp;</a></span>input_output_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void input_output_config </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configuration Function. </p>
<p>This function makes all the hardware configuration. Configures the input pins and the interruptions of the microcontroller. </p>

</div>
</div>
<a id="a6288eba0f8e8ad3ab1544ad731eb7667"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6288eba0f8e8ad3ab1544ad731eb7667">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void main </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main function of program. </p>
<p>The main function has the implementation of the state machine of the vending machine. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a398c25065c498b1c2e76b8047825bcbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a398c25065c498b1c2e76b8047825bcbc">&#9670;&nbsp;</a></span>button_pressed</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile int button_pressed = <a class="el" href="main_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag which indicates which panel button was pressed </p>

</div>
</div>
<a id="a19c255bf49fc3ac23d3b62e25a5ce365"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19c255bf49fc3ac23d3b62e25a5ce365">&#9670;&nbsp;</a></span>coin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile float coin = 0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Value of coin inserted </p>

</div>
</div>
<a id="ac34533d63de3056364aa3eb56553fe1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac34533d63de3056364aa3eb56553fe1a">&#9670;&nbsp;</a></span>coin_detected</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile int coin_detected = 0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag to signal that a coin was inserted </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="main_8c.html">main.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
